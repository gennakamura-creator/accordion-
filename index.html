<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>レセスタ｜初期設定サポート</title>
  <link rel="stylesheet" href="./styles.css?v=3" />
</head>
<body>

<header class="header">
  <div class="container">
    <h1>レセスタ 初期設定サポート</h1>
    <p class="sub">上から順に進めてください。今の位置は自動で表示されます。</p>
  </div>
</header>

<main class="container">
  <section class="card">

    <!-- 今ここ ステップ表示 -->
    <div class="steps" id="stepIndicator">
      <div class="step">① ZIPファイル保存</div>
      <div class="step">② ZIP解凍</div>
      <div class="step">③ 証明書</div>
      <div class="step">④ ログイン</div>
      <div class="step">⑤ パスワード変更</div>
      <div class="step">⑥ MediPort</div>
      <div class="step">⑦ 注意点</div>
    </div>

    <div class="accordion" id="faqAccordion">

      <!-- ① -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p1">
          ZIPファイルを保存（ダウンロード）したい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p1" hidden>
          <div class="acc-content">
            <ul>
              <li>メールで開いただけでは、保存は完了していません。</li>
              <li>添付ファイル横の <strong>ダウンロードボタン（↓）</strong> を押してください。</li>
              <li>案内に従って、パソコンに保存してください。</li>
            </ul>
            <button class="step-done-btn" data-step="1">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ② -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p2">
          ZIPファイルを解凍したい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p2" hidden>
          <div class="acc-content">
            <p><strong>Windows</strong></p>
            <ul>
              <li>右クリック →「すべて展開」</li>
              <li>パスワード入力</li>
            </ul>
            <p><strong>Mac</strong></p>
            <ul>
              <li>ZIPをダブルクリック → パスワード入力</li>
            </ul>
            <p>
              パスワードは <strong>申込時に指定した半角数字4桁</strong> です。
            </p>
            <button class="step-done-btn" data-step="2">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ③ -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p3">
          証明書（20xx_recesta.pfx）をインストールしたい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p3" hidden>
          <div class="acc-content">
            <p>
              「20xx_recesta.pfx」をダブルクリックし、  
              <strong>9_registration_info の最下行パスワード</strong>を入力してください。
            </p>

            <div class="mac-note">
              <div class="mac-note-title">🟨 Macをご利用の方へ（キーチェーン）</div>
              <ul>
                <li>Macログイン時のパスワードを求められる場合があります</li>
                <li>不明な場合は管理者へご確認ください</li>
                <li>不明な場合、Macでは設定できません</li>
              </ul>
            </div>

            <button class="step-done-btn" data-step="3">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ④ -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p4">
          レセスタにログインしたい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p4" hidden>
          <div class="acc-content">
            <p>
              <a href="https://app.recesta.jp/#/login" target="_blank">
                https://app.recesta.jp/#/login
              </a>
            </p>
            <p>RSから始まるIDとパスワードでログインしてください。</p>
            <button class="step-done-btn" data-step="4">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ⑤ -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p5">
          初回パスワードを変更したい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p5" hidden>
          <div class="acc-content">
            <ul>
              <li>8〜20文字</li>
              <li>英字・数字・記号を使用</li>
            </ul>
            <button class="step-done-btn" data-step="5">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ⑥ -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p6">
          MediPortにログインしたい
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p6" hidden>
          <div class="acc-content">
            <p>
              <a href="https://mediport.recesta.jp" target="_blank">
                https://mediport.recesta.jp
              </a>
            </p>
            <p>レセスタと同じID・パスワードです。</p>
            <button class="step-done-btn" data-step="6">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

      <!-- ⑦ -->
      <div class="acc-item">
        <button class="acc-trigger" aria-expanded="false" aria-controls="p7">
          利用時の注意点（縦覧点検）
          <span class="chev">▾</span>
        </button>
        <div class="acc-panel" id="p7" hidden>
          <div class="acc-content">
            <p>過去6ヶ月分のレセプトデータをご準備ください。</p>
            <button class="step-done-btn" data-step="7">☑ この工程は完了しました</button>
          </div>
        </div>
      </div>

    </div>
  </section>
</main>

<script src="./script.js?v=3" defer></script>

<script>
/* ===== 今ここ & 完了管理（index.html内完結） ===== */
const steps = document.querySelectorAll(".step");
const doneKey = "recesta_steps_done";
let done = JSON.parse(localStorage.getItem(doneKey) || "{}");

function refresh(){
  document.querySelectorAll(".step-done-btn").forEach(btn=>{
    const s = btn.dataset.step;
    btn.textContent = done[s] ? "✔ 完了済みです" : "☑ この工程は完了しました";
    btn.classList.toggle("is-done", !!done[s]);
  });
  steps.forEach((st,i)=>{
    st.classList.toggle("done", !!done[i+1]);
  });
}
refresh();

document.addEventListener("click", e=>{
  const btn = e.target.closest(".step-done-btn");
  if(btn){
    const s = btn.dataset.step;
    done[s] = !done[s];
    localStorage.setItem(doneKey, JSON.stringify(done));
    refresh();
  }
});

document.querySelectorAll(".acc-trigger").forEach((btn,i)=>{
  btn.addEventListener("click", ()=>{
    steps.forEach(s=>s.classList.remove("active"));
    steps[i].classList.add("active");
  });
});
</script>

</body>
</html>
